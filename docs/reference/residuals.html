<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate model fit residuals and assess their autocorrelation — residuals.ctmm • ctmm</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate model fit residuals and assess their autocorrelation — residuals.ctmm"><meta property="og:description" content="These functions calculate the residuals of a CTMM or UERE calibration model, which should be standardized and IID if the model correctly specified.
A correlogram method is also provided to assess autocorrelation.
This function is analogous to acf, but can handle missing data and multiple dimensions.
Finally, mag calculates residual magnitudes, which is useful for comparing against potential covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctmm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/variogram.html">Variograms and Model Selection</a>
    </li>
    <li>
      <a href="../articles/akde.html">Autocorrelated Kernel Density Estimation</a>
    </li>
    <li>
      <a href="../articles/error.html">Telemetry Error</a>
    </li>
    <li>
      <a href="../articles/interactions.html">Encounters and Interactions</a>
    </li>
    <li>
      <a href="../articles/periodogram.html">Periodograms and Periodicities</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ctmm-initiative/ctmm" class="external-link">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate model fit residuals and assess their autocorrelation</h1>
    
    <div class="hidden name"><code>residuals.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions calculate the residuals of a CTMM or UERE calibration model, which should be standardized and IID if the model correctly specified.
A correlogram method is also provided to assess autocorrelation.
This function is analogous to <code>acf</code>, but can handle missing data and multiple dimensions.
Finally, <code>mag</code> calculates residual magnitudes, which is useful for comparing against potential covariates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code>&lt;!-- %residuals(object,...) --&gt;
# S3 method for ctmm
residuals(object,data,...)

# S3 method for telemetry
residuals(object,CTMM=NULL,...)

correlogram(data,dt=NULL,fast=TRUE,res=1,axes=c("x","y"),trace=TRUE)

mag(x,...)

# S3 method for telemetry
mag(x,axes=c('x','y'),...)</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p><code>ctmm</code> model object or <code>telemetry</code> data object for calculating residuals.</p></dd>

  <dt>data</dt>
<dd><p><code>telemetry</code> data object or <code>data.frame</code> with time column <code>t</code> and data columns <code>axes</code>.</p></dd>

  <dt>CTMM</dt>
<dd><p><code>ctmm</code> model object. If <code>NULL</code>, the data is treated as (calibrated) calibration data.</p></dd>

  <dt>...</dt>
<dd><p>Unused arguments.</p></dd>

  <dt>dt</dt>
<dd><p>Lag bin width. An ordered array will yield a progressive coarsening of the lags. Defaults to the median sampling interval.</p></dd>

  <dt>fast</dt>
<dd><p>Use the lag-weighted algorithm if <code>FALSE</code> or the FFT algorithm if <code>TRUE</code>. The slow algorithm outputs a progress bar.</p></dd>

  <dt>res</dt>
<dd><p>Increase the discretization resolution for irregularly sampled data with <code>res&gt;1</code>. Decreases bias at the cost of smoothness.</p></dd>

  <dt>axes</dt>
<dd><p>Array of axes for which to calculate residual correlogram or magnitudes.</p></dd>

  <dt>trace</dt>
<dd><p>Display a progress bar if <code>fast=FALSE</code>.</p></dd>

  <dt>x</dt>
<dd><p><code>telemetry</code> object from the output of <code>residuals</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Given a <code>telemetry</code> dataset and <code>ctmm</code> model, <code>residuals</code> calculates the standardized residuals of the Kalman filter, which can be tested for independence. The residuals object can then be plotted with <code>plot</code> or fed into the <code>correlogram</code> method to test independence. Output of the correlogram can then be plotted as well, though <code>zoom</code> is much more useful.</p>
<p>When calculating correlograms, minimizing bias is more important than producing a overall smooth estimate. If <code>fast=TRUE</code>, then <code>res</code> needs to be large enough to resolve variability in the sampling interval (missing data is permitted). E.g., if the sampling interval is set to 15 minutes, but can be off by a minute or two, then <code>res=15</code> is a good choice.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>residuals</code> return a residual object (class <code>telemetry</code>, but flagged as residual) and <code>correlogram</code> returns a correlogram object (class <code>variogram</code>, but flagged as an ACF).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>C. H. Fleming, D. Sheldon, E. Gurarie, W. F. Fagan, S. LaPoint, J. M. Calabrese,
``Kálmán filters for continuous-time movement models'',
Ecological Informatics, 40, 8-21 (2017) <a href="https://doi.org/10.1016/j.ecoinf.2017.04.008" class="external-link">doi:10.1016/j.ecoinf.2017.04.008</a>
.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>C. H. Fleming</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>If the sampling schedule is irregular, permitting gaps, then the correlogram may not look good even if the model is correctly specified. In this case the correlogram of the residuals should be compared to the correlogram of simulated residuals, using "data" simulated from the fit model and with the same sampling schedule.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.variogram.html">plot.variogram</a></code>, <code><a href="variogram.html">variogram</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load package and data</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ctmm-initiative/ctmm" class="external-link">ctmm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Cilla</span> <span class="op">&lt;-</span> <span class="va">buffalo</span><span class="op">$</span><span class="va">Cilla</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit a model</span></span></span>
<span class="r-in"><span><span class="va">GUESS</span> <span class="op">&lt;-</span> <span class="fu"><a href="variogram.fit.html">ctmm.guess</a></span><span class="op">(</span><span class="va">Cilla</span>,interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">FIT</span> <span class="op">&lt;-</span> <span class="fu"><a href="ctmm.fit.html">ctmm.fit</a></span><span class="op">(</span><span class="va">Cilla</span>,<span class="va">GUESS</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate residuals</span></span></span>
<span class="r-in"><span><span class="va">RES</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">Cilla</span>,<span class="va">FIT</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># scatter plot of residuals with 50%, 95%, and 99.9% quantiles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">RES</span>,col.DF<span class="op">=</span><span class="cn">NA</span>,level.UD<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.50</span>,<span class="fl">.95</span>,<span class="fl">0.999</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="residuals-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate correlogram of residuals</span></span></span>
<span class="r-in"><span><span class="co"># increase the res argument to account for sampling variability</span></span></span>
<span class="r-in"><span><span class="va">ACF</span> <span class="op">&lt;-</span> <span class="fu">correlogram</span><span class="op">(</span><span class="va">RES</span>,res<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot 4 day's worth of lags</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">ACF</span><span class="op">[</span><span class="va">ACF</span><span class="op">$</span><span class="va">lag</span><span class="op">&lt;=</span><span class="fl">4</span> <span class="op"><a href="unit.html">%#%</a></span> <span class="st">'day'</span>,<span class="op">]</span>,fraction<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="residuals-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

