<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate the optimal bandwidth matrix of movement data — bandwidth • ctmm</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate the optimal bandwidth matrix of movement data — bandwidth"><meta property="og:description" content="This function calculates the optimal bandwidth matrix (kernel covariance) for a two-dimensional animal tracking dataset, given an autocorrelated movement model (Fleming et al, 2015). This optimal bandwidth can fully take into account all autocorrelation in the data, assuming it is captured by the movement model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctmm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/variogram.html">Variograms and Model Selection</a>
    </li>
    <li>
      <a href="../articles/akde.html">Autocorrelated Kernel Density Estimation</a>
    </li>
    <li>
      <a href="../articles/error.html">Telemetry Error</a>
    </li>
    <li>
      <a href="../articles/interactions.html">Encounters and Interactions</a>
    </li>
    <li>
      <a href="../articles/periodogram.html">Periodograms and Periodicities</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ctmm-initiative/ctmm" class="external-link">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the optimal bandwidth matrix of movement data</h1>
    
    <div class="hidden name"><code>bandwidth.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates the optimal bandwidth matrix (kernel covariance) for a two-dimensional animal tracking dataset, given an autocorrelated movement model (Fleming et al, 2015). This optimal bandwidth can fully take into account all autocorrelation in the data, assuming it is captured by the movement model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bandwidth</span><span class="op">(</span><span class="va">data</span>,<span class="va">CTMM</span>,VMM<span class="op">=</span><span class="cn">NULL</span>,weights<span class="op">=</span><span class="cn">FALSE</span>,fast<span class="op">=</span><span class="cn">NULL</span>,dt<span class="op">=</span><span class="cn">NULL</span>,PC<span class="op">=</span><span class="st">"Markov"</span>,error<span class="op">=</span><span class="fl">0.01</span>,</span>
<span>          precision<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,verbose<span class="op">=</span><span class="cn">FALSE</span>,trace<span class="op">=</span><span class="cn">FALSE</span>,dt.plot<span class="op">=</span><span class="cn">TRUE</span>,<span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>2D timeseries telemetry data represented as a <code>telemetry</code> object.</p></dd>

  <dt>CTMM</dt>
<dd><p>A <code>ctmm</code> movement model as from the output of <code>ctmm.fit</code>.</p></dd>

  <dt>VMM</dt>
<dd><p>An optional vertical <code>ctmm</code> object for 3D bandwidth calculation.</p></dd>

</dl><p><!-- %  \item{UD}{A list of \code{UD} objects for calculating population weights and bandwidth [IN DEVELOPMENT].} --></p>


<p><!-- %  \item{h}{Fixed bandwidth value.} --></p>
<dl><dt>weights</dt>
<dd><p>By default, the weights are taken to be uniform, whereas <code>weights=TRUE</code> will optimize the weights.</p></dd>

  <dt>fast</dt>
<dd><p>Use FFT algorithms for weight optimization. <code>fast=NULL</code> will attempt to intelligently decide between the fast and exact algorithms based on computational complexity.</p></dd>

  <dt>dt</dt>
<dd><p>Optional lag bin width for the FFT algorithm.</p></dd>

  <dt>PC</dt>
<dd><p>Preconditioner to use: can be "Markov", "circulant", "IID", or "direct".</p></dd>

  <dt>error</dt>
<dd><p>Maximum grid error for FFT algorithm, if <code>dt</code> is not specified.</p></dd>

  <dt>precision</dt>
<dd><p>Fraction of maximum possible digits of precision to target in weight optimization. <code>precision=1/2</code> results in about 7 decimal digits of precision if the preconditioner is stable.</p></dd>

  <dt>verbose</dt>
<dd><p>Optionally return the optimal <code>weights</code>, effective sample size <code>DOF.H</code>, and other information along with the bandwidth matrix <code>H</code>.</p></dd>

  <dt>trace</dt>
<dd><p>Produce tracing information on the progress of weight optimization.</p></dd>

  <dt>dt.plot</dt>
<dd><p>Execute a diagnostic <code><a href="dt.plot.html">dt.plot</a></code> with a red line at <code>dt</code>, if <code>weights=TRUE</code>.</p></dd>

  <dt>...</dt>
<dd><p>Arguments passed to <code><a href="mean.html">mean.ctmm</a></code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>weights=TRUE</code> argument can be used to correct temporal sampling bias caused by autocorrelation.
<code>weights=TRUE</code> will optimize <code>n=length(data$t)</code> weights via constrained &amp; preconditioned conjugate gradient algorithms.
These algorithms have a few options that should be considered if the data are very irregular.</p>
<p><code>fast=TRUE</code> is an approximation that discretizes the data with timestep <code>dt</code> and applies FFT algorithms, for a computational cost as low as \(O(n \log n)\) with only \(O(n)\) function evaluations.
If no <code>dt</code> is specified, then a choice of <code>dt</code> will be automated with a message.
<strong>If the data contain some very tiny time intervals</strong>, say 1 second among hourly sampled data, then the default <code>dt</code> setting can create an excessively high-resolution discretization of time, which will cause slowdown. In this case <code>CTMM</code> should contain a location-error model and <code>dt</code> should be increased to a larger fraction of the most-frequent sampling intervals.
<strong>If the data are irregular (permitting gaps), then <code>dt</code> may need to be several times smaller</strong> than the median to avoid slow down.
In this case, try setting <code>trace=TRUE</code> and decreasing <code>dt</code> below the median until the interations speed up and the number of feasibility assessments becomes less than \(O(n)\).
<!-- %With the sub-optimal \code{PC="IID"} preconditioner, \code{dt} can be relaxed to the median value, but the computational cost is then increased to \eqn{O(n^2 \log n)}. --></p>
<p><code>fast=FALSE</code> uses exact time spacing and has a computational cost as low as \(O(n^2)\), including \(O(n^2)\) function evaluations. With <code>PC="direct"</code> this method will produce a result that is exact to within machine precision, but with a computational cost of \(O(n^3)\). <strong><code>fast=FALSE,PC='direct'</code> is often the fastest method with small datasets</strong>, where \(n \le O\)(1,000), but scales terribly with larger datasets.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a bandwidth <code>matrix</code> object, which is to be the optimal covariance matrix of the individual kernels of the kernel density estimate.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>T. F. Chan,
``An Optimal Circulant Preconditioner for Toeplitz Systems'',
SIAM Journal on Scientific and Statistical Computing, 9:4, 766-771 (1988) <a href="https://doi.org/10.1137/0909051" class="external-link">doi:10.1137/0909051</a>
.</p>
<p>D. Marcotte, ``Fast variogram computation with FFT'', Computers and Geosciences 22:10, 1175-1186 (1996) <a href="https://doi.org/10.1016/S0098-3004%2896%2900026-X" class="external-link">doi:10.1016/S0098-3004(96)00026-X</a>
.</p>
<p>C. H. Fleming, W. F. Fagan, T. Mueller, K. A. Olson, P. Leimgruber, J. M. Calabrese,
``Rigorous home-range estimation with movement data: A new autocorrelated kernel-density estimator'',
Ecology, 96:5, 1182-1188 (2015) <a href="https://doi.org/10.1890/14-2010.1" class="external-link">doi:10.1890/14-2010.1</a>
.</p>
<p>C. H. Fleming, D. Sheldon, W. F. Fagan, P. Leimgruber, T. Mueller, D. Nandintsetseg, M. J. Noonan, K. A. Olson, E. Setyawan, A. Sianipar, J. M. Calabrese,
``Correcting for missing and irregular data in home-range estimation'',
Ecological Applications, 28:4, 1003-1010 (2018) <a href="https://doi.org/10.1002/eap.1704" class="external-link">doi:10.1002/eap.1704</a>
.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>C. H. Fleming.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>To obtain a bandwidth scalar representing the variance of each kernel, a <code>ctmm</code> object with <code>isotropic=TRUE</code> is required.  In this case, <code>bandwidth</code> will return bandwidth matrix with identical variances along its diagonal. Note that forcing <code>isotropic=TRUE</code> will provide an inaccurate estimate for very eccentric distributions.</p>
<p>In v1.0.1 the default <code>fast</code>, <code>dt</code>, <code>PC</code> arguments depend on the sample size, with <code>fast=FALSE</code>, <code>PC="Direct"</code> for small sample sizes, <code>fast=FALSE</code>, <code>PC="Markov"</code> for moderate sample sizes, and <code>fast=TRUE</code>, <code>PC="Markov"</code> for large sample sizes, where <code>dt</code> is taken to be the integer fraction of the median sampling interval closest to the minimum sampling interval.</p>
<p>In v0.6.2 the default <code>dt</code> was increased form the minimum time difference to a small quantile no less than <code>error</code> times the median.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="akde.html">akde</a></code>, <code><a href="ctmm.fit.html">ctmm.fit</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

