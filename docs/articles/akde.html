<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Autocorrelated Kernel Density Estimation • ctmm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Autocorrelated Kernel Density Estimation">
<meta property="og:description" content="ctmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctmm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/variogram.html">Variograms and Model Selection</a>
    </li>
    <li>
      <a href="../articles/akde.html">Autocorrelated Kernel Density Estimation</a>
    </li>
    <li>
      <a href="../articles/error.html">Telemetry Error</a>
    </li>
    <li>
      <a href="../articles/interactions.html">Encounters and Interactions</a>
    </li>
    <li>
      <a href="../articles/periodogram.html">Periodograms and Periodicities</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ctmm-initiative/ctmm" class="external-link">
    <span class="fa fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Autocorrelated Kernel Density Estimation</h1>
                        <h4 data-toc-skip class="author">Christen H. Fleming and Justin M. Calabrese</h4>
            
            <h4 data-toc-skip class="date">2023-09-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ctmm-initiative/ctmm/blob/HEAD/vignettes/akde.Rmd" class="external-link"><code>vignettes/akde.Rmd</code></a></small>
      <div class="hidden name"><code>akde.Rmd</code></div>

    </div>

    
    
<p>In this vignette we walk through autocorrelated kernel density estimation. We will assume that you have already estimated a good <code>ctmm</code> movement model for your data. For demonstration purposes we will be working from the results of the “Variograms and Model Selection” vignette (see <code><a href="../articles/variogram.html">vignette("variogram")</a></code>). Here we will use the buffalo “Pepper” instead of “Cilla”, because Pepper has a GPS collar malfunction that can be mitigated with optimal weighting.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ctmm-initiative/ctmm" class="external-link">ctmm</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,</span></span>
<span><span class="co">## which was just loaded, will retire in October 2023.</span></span>
<span><span class="co">## Please refer to R-spatial evolution reports for details, especially</span></span>
<span><span class="co">## https://r-spatial.org/r/2023/05/15/evolution4.html.</span></span>
<span><span class="co">## It may be desirable to make the sf package available;</span></span>
<span><span class="co">## package maintainers should consider adding sf to Suggests:.</span></span>
<span><span class="co">## The sp package is now running under evolution status 2</span></span>
<span><span class="co">##      (status 2 uses the sf package in place of rgdal)</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">buffalo</span><span class="op">)</span></span>
<span><span class="va">Pepper</span> <span class="op">&lt;-</span> <span class="va">buffalo</span><span class="op">$</span><span class="va">Pepper</span></span>
<span><span class="va">M.IID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctmm.fit.html">ctmm.fit</a></span><span class="op">(</span><span class="va">Pepper</span><span class="op">)</span> <span class="co"># no autocorrelation timescales</span></span>
<span><span class="va">GUESS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/variogram.fit.html">ctmm.guess</a></span><span class="op">(</span><span class="va">Pepper</span>,interactive<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># automated model guess</span></span>
<span><span class="va">M.OUF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctmm.fit.html">ctmm.fit</a></span><span class="op">(</span><span class="va">Pepper</span>,<span class="va">GUESS</span><span class="op">)</span> <span class="co"># in general, use ctmm.select instead</span></span></code></pre></div>
<p><code>M.IID</code> is the innapropriate, IID model, which will result in a conventional kernel-density estimate, while <code>M.OUF</code> is the superior, continuous-velocity OUF model. Note that you want the best model for each individual, even if that differs by individual. Different movement behaviors and sampling schedules will reveal different autocorrelation structures in the data.</p>
<p>Now we can calculate a uniformly weighted <code>akde</code> object for each model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KDE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/akde.html">akde</a></span><span class="op">(</span><span class="va">Pepper</span>,<span class="va">M.IID</span><span class="op">)</span> <span class="co"># KDE</span></span>
<span><span class="va">AKDE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/akde.html">akde</a></span><span class="op">(</span><span class="va">Pepper</span>,<span class="va">M.OUF</span><span class="op">)</span> <span class="co"># AKDE</span></span></code></pre></div>
<pre><code><span><span class="co">## Default grid size of 3 minutes chosen for bandwidth(...,fast=TRUE).</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wAKDE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/akde.html">akde</a></span><span class="op">(</span><span class="va">Pepper</span>,<span class="va">M.OUF</span>,weights<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># weighted AKDE</span></span></code></pre></div>
<pre><code><span><span class="co">## Default grid size of 3 minutes chosen for bandwidth(...,fast=TRUE).</span></span></code></pre>
<p><img src="akde_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>However, Pepper’s sampling schedule is anything but uniform.</p>
<p>Keeping in mind that Pepper’s home-range crossing timescale is two weeks, we have several algorithms for calculating optimal weights here. The exact algorithm is the easiest to implement, but it can be prohibitively slow on larger datasets (10k-100k). On the other hand, the fast algorithm can scale to extremely large datasets, but requires an appropriate discrete-time grid <code>dt</code> argument, which should be a divisor of the most frequent sampling intervals that can approximate the smallest sampling intervals. The default will try to intelligently choose among these methods, and the above plot depicts the selected <code>dt</code> in red. Large volumes of data (&gt;100k) collected over a long period of time with finely sampled bursts (period/interval <span class="math inline">\(\gg\)</span> millions) will not work well with either of the default algorithms. In this case, the user needs to thin their data if optimal weights are required. There is no significant home-range information lost by doing so in such extreme cases.</p>
<p>Now let us plot the results.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate one extent for all UDs</span></span>
<span><span class="va">EXT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extent.html">extent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">KDE</span>,<span class="va">AKDE</span>,<span class="va">wAKDE</span><span class="op">)</span>,level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">Pepper</span>,UD<span class="op">=</span><span class="va">KDE</span>,xlim<span class="op">=</span><span class="va">EXT</span><span class="op">$</span><span class="va">x</span>,ylim<span class="op">=</span><span class="va">EXT</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"IID KDE"</span><span class="op">[</span><span class="st">"C"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">Pepper</span>,UD<span class="op">=</span><span class="va">AKDE</span>,xlim<span class="op">=</span><span class="va">EXT</span><span class="op">$</span><span class="va">x</span>,ylim<span class="op">=</span><span class="va">EXT</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"OUF AKDE"</span><span class="op">[</span><span class="st">"C"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.telemetry.html">plot</a></span><span class="op">(</span><span class="va">Pepper</span>,UD<span class="op">=</span><span class="va">wAKDE</span>,xlim<span class="op">=</span><span class="va">EXT</span><span class="op">$</span><span class="va">x</span>,ylim<span class="op">=</span><span class="va">EXT</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"weighted OUF AKDE"</span><span class="op">[</span><span class="st">"C"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DOP values missing. Assuming DOP=1.</span></span>
<span><span class="co">## DOP values missing. Assuming DOP=1.</span></span>
<span><span class="co">## DOP values missing. Assuming DOP=1.</span></span></code></pre>
<p><img src="akde_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="akde_files/figure-html/unnamed-chunk-4-2.png" width="700"><img src="akde_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
<p>By default both the density function and its 95% contours are plotted along with the location data. The middle contour represent the maximum likelihood area where the animal spends 95% of its time. This percentage can be changed with the <code>level.UD</code> option (see <code><a href="../reference/plot.telemetry.html">help(plot.telemetry)</a></code>). The inner and outer contours correspond to confidence intervals on the magnitude of the area, which can be adjusted with the <code>level</code> option.</p>
<p>The optimal bandwidth determines the “resolution” of the kernel density estimate. By default we plot grid lines with dimensions matching the standard deviations of the individual kernels. This gives a rough guideline as to what spatial details are and are not important in the density estimate. One can see that the IID KDE<sub>C</sub> estimate fits tightly to the data and reports many significant details in the buffalo’s home range. The autocorrelated estimates predict future space use more accurately, based on the diffusion model, and yield a more honest account of their uncertainties.</p>
<p>In the case of Pepper, the GPS collar malfunctioned during data collection and the sampling interval mysteriously changed from 1 hour (yellow) to 2 hours (red). This irregularity makes Pepper a good candidate for optimally weighted AKDE (<code>weights=TRUE</code>). The optimally weighted estimate features smaller error, finer resolution, and mitigation of sampling bias. You can see that the uniformly weighted estimates place excessive emphasis on the oversampled data (yellow).</p>
<p>Finally, we can compare the area estimates and effective sample sizes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">KDE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $DOF</span></span>
<span><span class="co">##      area bandwidth </span></span>
<span><span class="co">##  1724.000  1723.906 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $CI</span></span>
<span><span class="co">##                               low      est    high</span></span>
<span><span class="co">## area (square kilometers) 436.7497 458.1221 479.998</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "area"</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wAKDE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $DOF</span></span>
<span><span class="co">##      area bandwidth </span></span>
<span><span class="co">##  15.65770  28.16612 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $CI</span></span>
<span><span class="co">##                               low      est     high</span></span>
<span><span class="co">## area (square kilometers) 432.2446 761.4926 1182.435</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "area"</span></span></code></pre>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christen H. Fleming, Justin M. Calabrese.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
